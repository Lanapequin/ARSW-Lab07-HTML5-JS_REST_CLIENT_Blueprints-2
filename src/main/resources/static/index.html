<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
    <head>
        <title>Blueprints</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="/webjars/jquery/3.1.0/jquery.min.js"></script>
        <script src="/webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="js/apimock.js"></script>
        <script src="js/apiclient.js"></script>
        <script src="js/app.js"></script>
        <script>
            $(document).ready(function () {
              function triggerBlueprintSearch() {
                const author = $("#searchQuery").val().trim();
                if (author) {
                  app.updateBlueprints(author);
                } else {
                  alert("Please enter an author name.");
                }
              }

              $(".search-icon").on("click", function () {
                triggerBlueprintSearch();
              });

              $("#searchQuery").on("keydown", function (e) {
                if (e.key === "Enter") {
                  triggerBlueprintSearch();
                }
              });
            });
        </script>
        <link rel="stylesheet" href="/webjars/bootstrap/3.3.7/css/bootstrap.min.css" />
        <link rel="stylesheet" href="styles/app.css">

    </head>
    <body>
        <div id="header">
            <div class="header-text-wrapper">Blueprints</div>
            <div class="search-wrapper">
                <input type="search" id="searchQuery" placeholder="Search...">
                <img alt="search-icon" src="img/magnifying-glass-icon.png" width="18" height="18" class="search-icon">
            </div>
        </div>
        <div class="content">
            <div class="message">
                <div class="line">
                    <img alt="search-icon" src="img/magnifying-glass-icon.png" width="32" height="32">
                    <span id="user-message" class="header-text-wrapper">No user selected</span>
                </div>
                <span class="body-text-wrapper">Search for a username to view their blueprints and stats.</span>
            </div>
            <div class="left-panel" style="display: none;">
                <span id="currentBlueprintName" class="subtitle-text-wrapper">Current blueprint: None</span>
                <canvas id="blueprintCanvas" style="border:1px solid #ccc;border-radius: 20px;"></canvas>
                <div>
                    <button id="saveBlueprintBtn" class="btn btn-secondary" style="margin-top: 10px;">Save/Update</button>
                    <button id="deleteBlueprintBtn" class="btn btn-secondary" style="margin-top: 10px;">Delete</button>
                </div>
            </div>
            <div class="right-panel" style="display: none;">
                <span class="subtitle-text-wrapper" id="authorName"></span>
                <div class="table-container">
                    <table id="blueprints-table">
                        <thead>
                        <tr>
                            <th class="body-text-wrapper">Blueprint name</th>
                            <th class="body-text-wrapper">Number of Points</th>
                            <th class="body-text-wrapper">Open</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <span id="totalPoints"></span>
            </div>
        </div>
        <script>
            window.onload = function() {
                app.drawDefaultImage();
                app.initCanvasEvents();

                document.getElementById("saveBlueprintBtn").addEventListener("click", app.saveOrUpdateBlueprint);
                document.getElementById("deleteBlueprintBtn").addEventListener("click", app.deleteBlueprint);

                window.addEventListener("resize", () => {
                    const canvas = document.getElementById("blueprintCanvas");
                    canvas.width = canvas.offsetWidth;
                    canvas.height = canvas.offsetHeight;
                    app.repaintBlueprint();
                });

                document.addEventListener("contextmenu", function (event) {
                    event.preventDefault();
                });
            };
        </script>
    </body>
</html>